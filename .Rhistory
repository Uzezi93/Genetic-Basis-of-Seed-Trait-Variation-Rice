# Plot Anova for Solidity
solid_anova <- ggplot(phenotypes, aes(Sub.Populaton, Solidity)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="Solidity") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Sol_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 6, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
solid_anova
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Solidity_Anova.tiff",
plot = solid_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
#------------------------------------------------------------
# Plot Anova for Solidity
solid_anova <- ggplot(phenotypes, aes(Sub.Populaton, Solidity)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="Solidity") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Sol_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
solid_anova
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Solidity_Anova.tiff",
plot = solid_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Solidity_Anova.tiff",
plot = solid_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1.5)  # Increase scale factor to keep text large
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Solidity_Anova.tiff",
plot = solid_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1.2)  # Increase scale factor to keep text large
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Solidity_Anova.tiff",
plot = solid_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
#------------------------------------------------------------
# Plot Anova for Eccentricity
ecc_anova <- ggplot(phenotypes, aes(Sub.Populaton, Eccentricity)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="Eccentricity") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Ecc_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
ecc_anova
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Eccentricity_Anova.tiff",
plot = solid_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Eccentricity_Anova.tiff",
plot = ecc_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
#------------------------------------------------------------
# Plot Anova for Solidity
area_anova <- ggplot(phenotypes, aes(Sub.Populaton, Area)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="Area") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Area_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
area_anova
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Area_Anova.tiff",
plot = area_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
#------------------------------------------------------------
# Plot Anova for CH Vertices
CHV_anova <- ggplot(phenotypes, aes(Sub.Populaton, CH.Vertices)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="CH.Vertices") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Sol_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
CHV_anova
#------------------------------------------------------------
# Plot Anova for CH Vertices
CHV_anova <- ggplot(phenotypes, aes(Sub.Populaton, CH.Vertices)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="CH.Vertices") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Sol_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
CHV_anova
#------------------------------------------------------------
# Plot Anova for CH Vertices
CHV_anova <- ggplot(phenotypes, aes(Sub.Populaton, CH.Vertices)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="CH.Vertices") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Sol_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-5, hjust =-1) +
scale_fill_brewer(palette = "Blues")
CHV_anova
#------------------------------------------------------------
# Plot Anova for CH Vertices
CHV_anova <- ggplot(phenotypes, aes(Sub.Populaton, CH.Vertices)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="CH.Vertices") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Sol_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-10, hjust =-3) +
scale_fill_brewer(palette = "Blues")
CHV_anova
#------------------------------------------------------------
# Plot Anova for CH Vertices
CHV_anova <- ggplot(phenotypes, aes(Sub.Populaton, CH.Vertices)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="CH.Vertices") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Sol_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-10, hjust =3) +
scale_fill_brewer(palette = "Blues")
CHV_anova
#------------------------------------------------------------
# Plot Anova for CH Vertices
CHV_anova <- ggplot(phenotypes, aes(Sub.Populaton, CH.Vertices)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="CH.Vertices") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Sol_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-10, hjust =5) +
scale_fill_brewer(palette = "Blues")
CHV_anova
#------------------------------------------------------------
# Plot Anova for CH Vertices
CHV_anova <- ggplot(phenotypes, aes(Sub.Populaton, CH.Vertices)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="CH.Vertices") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Sol_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
CHV_anova
#------------------------------------------------------------
# Plot Anova for CH Vertices
CHV_anova <- ggplot(phenotypes, aes(Sub.Populaton, CH.Vertices)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="CH.Vertices") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = CHV_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
CHV_anova
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/CH.Verices_Anova.tiff",
plot = CHV_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
#----------------------------------------------------------
# Plot Anova for CH Area
CHA_anova <- ggplot(phenotypes, aes(Sub.Populaton, CH.Area)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="CH.Area") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = CHV_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
CHA_anova
#----------------------------------------------------------
# Plot Anova for CH Area
CHA_anova <- ggplot(phenotypes, aes(Sub.Populaton, CH.Area)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="CH.Area") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = CHA_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
CHA_anova
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/CH.Area_Anova.tiff",
plot = CHA_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
#-----------------------------------------------------------
# Plot Anova for Minor Axis
Min_anova <- ggplot(phenotypes, aes(Sub.Populaton, Minor.Axis)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="Minor.Axis") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = CHV_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
Min_anova
#-----------------------------------------------------------
# Plot Anova for Minor Axis
Min_anova <- ggplot(phenotypes, aes(Sub.Populaton, Minor.Axis)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="Minor.Axis") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = MinA_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
Min_anova
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Minor_Axis_Anova.tiff",
plot = Min_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
#------------------------------------------------------------
# Plot Anova for Minor Axis
Maj_anova <- ggplot(phenotypes, aes(Sub.Populaton, Major.Axis)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="Major.Axis") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = MajA_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
Maj_anova
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Major_Axis_Anova.tiff",
plot = Maj_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
#------------------------------------------------------------
# Plot Anova for Minor Axis
per_anova <- ggplot(phenotypes, aes(Sub.Populaton, Perimeter)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="Perimeter") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = MinA_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
per_anova
#------------------------------------------------------------
# Plot Anova for Minor Axis
per_anova <- ggplot(phenotypes, aes(Sub.Populaton, Perimeter)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="Perimeter") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Per_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
per_anova
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Perimeter_Anova.tiff",
plot = per_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
View(per_anova)
#------------------------------------------------------------
# Plot Anova for Minor Axis
lon_anova <- ggplot(phenotypes, aes(Sub.Populaton, Longest.Path)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="Longest.Path") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = Lon_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
lon_anova
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Longest.Path_Anova.tiff",
plot = lon_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
#------------------------------------------------------------
# Plot Anova for Seed Weight
sw_anova <- ggplot(phenotypes, aes(Sub.Populaton, seed_weight)) +
geom_boxplot(aes(fill = factor(..middle..)), show.legend = FALSE) +
labs(x="Subpopulation", y="Seed.Weight") +
theme_bw() +
theme(
axis.text = element_text(size = 18),  # Increase axis tick labels
axis.title = element_text(size = 20, face = "bold"),  # Increase axis titles
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Increase title size and center it
) +
geom_text(data = SW_Tk, aes(x = Sub.Populaton, y = quant, label = cld), size = 8, vjust=-1, hjust =-1) +
scale_fill_brewer(palette = "Blues")
sw_anova
ggsave("USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/Seed_Weight_Anova.tiff",
plot = sw_anova,
device = "tiff",
width = 5, height = 4,
dpi = 300, scale = 1)  # Increase scale factor to keep text large
#tiff("WW_Trait_Distributions.tiff", res = 300, height = 25, width = 25, units = "cm")
dist <- grid.arrange(p2, p3, p4, p5, p6, p7, p10, p11, p12, ncol= 3)
View(dist)
dist
#tiff("WW_Trait_Distributions.tiff", res = 300, height = 25, width = 25, units = "cm")
grid.arrange(p2, p3, p4, p5, p6, p7, p10, p11, p12, ncol= 3)
p2 <- ggplot(metrics.noOut2, aes(x = Eccentricity)) +
geom_density(fill = "lightblue", alpha = 0.7) + xlab("Ellipse Eccentricity") + theme_bw() +
theme(axis.title = element_text(size = 12),
axis.text = element_text(size = 12))
p3 <- ggplot(metrics.noOut2, aes(x = Solidity)) +
geom_density(fill = "lightblue", alpha = 0.7) + xlab("Solidity") + xlim(c(0.85, 1.1)) +
theme_bw() +
theme(axis.title = element_text(size = 12),
axis.text = element_text(size = 12))
p4 <- ggplot(metrics.noOut2, aes(x = CH.Vertices)) +
geom_density(fill = "lightblue", alpha = 0.7) + xlab("Convex Hull Vertices") + theme_bw() +
theme(axis.title = element_text(size = 12),
axis.text = element_text(size = 12))
p5 <- ggplot(metrics.noOut2, aes(x = Area)) +
geom_density(fill = "lightblue", alpha = 0.7) + xlab("Seed Area") + theme_bw() +
theme(axis.title = element_text(size = 12),
axis.text = element_text(size = 12))
p6 <- ggplot(metrics.noOut2, aes(x = CH.Area)) +
geom_density(fill = "lightblue", alpha = 0.7) + xlab("Convex Hull Area") + theme_bw() +
theme(axis.title = element_text(size = 12),
axis.text = element_text(size = 12))
p7 <- ggplot(metrics.noOut2, aes(x = Perimeter)) +
geom_density(fill = "lightblue", alpha = 0.7) + xlab("Perimeter") + theme_bw() +
theme(axis.title = element_text(size = 12),
axis.text = element_text(size = 12))
p10 <- ggplot(metrics.noOut2, aes(x = Longest.Path)) +
geom_density(fill = "lightblue", alpha = 0.7) + xlab("Longest Path") + theme_bw() +
theme(axis.title = element_text(size = 12),
axis.text = element_text(size = 12))
p11 <- ggplot(metrics.noOut2, aes(x = Major.Axis)) +
geom_density(fill = "lightblue", alpha = 0.7) + xlab("Ellipse Major Axis") + theme_bw() +
theme(axis.title = element_text(size = 12),
axis.text = element_text(size = 12))
p12 <- ggplot(metrics.noOut2, aes(x = Minor.Axis)) +
geom_density(fill = "lightblue", alpha = 0.7) + xlab("Ellipse Minor Axis") + theme_bw() +
theme(axis.title = element_text(size = 12),
axis.text = element_text(size = 12))
#tiff("WW_Trait_Distributions.tiff", res = 300, height = 25, width = 25, units = "cm")
grid.arrange(p2, p3, p4, p5, p6, p7, p10, p11, p12, ncol= 3)
phenomass <- phenotypes %>%
dplyr::mutate(mass = seed_weight/Area)
ggplot(data = phenomass, aes(x = Solidity, y = mass, color = `sub-population`)) +
geom_point() +
geom_smooth(method = "lm")
phenomass <- phenotypes %>%
dplyr::mutate(mass = seed_weight/Area)
ggplot(data = phenomass, aes(x = Solidity, y = mass, color = sub_population)) +
geom_point() +
geom_smooth(method = "lm")
phenomass <- phenotypes %>%
dplyr::mutate(mass = seed_weight/Area)
ggplot(data = phenomass, aes(x = Solidity, y = mass, color = Sub.Population)) +
geom_point() +
geom_smooth(method = "lm")
View(phenomass)
phenomass <- phenotypes %>%
dplyr::mutate(mass = seed_weight/Area)
ggplot(data = phenomass, aes(x = Solidity, y = mass, color = Sub.Population)) +
geom_point() +
geom_smooth(method = "lm")
# Read the text file (change the filename accordingly)
text_data <- readLines("~/Documents/Genetic-Basis-of-Seed-Trait-Variation-Rice/USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/chr3_upstream.txt")
# Extract gene IDs using regex
gene_ids <- str_extract(text_data, "Os\\d{2}g\\d{3}")
# Remove NA values (if any)
gene_ids <- gene_ids[!is.na(gene_ids)]
# Print the extracted gene IDs
print(gene_ids)
text_data
# Extract gene IDs using regex
gene_ids <- str_extract(text_data, "(?<=Name=)Os\\d{2}g\\d{7}"))
# Extract gene IDs using regex
gene_ids <- str_extract(text_data, "(?<=Name=)Os\\d{2}g\\d{3}"))
# Extract the gene IDs by removing "Name="
gene_ids <- sub(".*Name=(Os\\d{2}g\\d{7}).*", "\\1", text_data)
# Keep only valid gene IDs (removes unchanged lines)
gene_ids <- gene_ids[grepl("^Os\\d{2}g\\d{7}$", gene_ids)]
# Print the extracted gene IDs
print(gene_ids)
# Save the extracted gene IDs to a new file
writeLines(gene_ids, "~/Documents/Genetic-Basis-of-Seed-Trait-Variation-Rice/USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/chr3_upstream.txt")
#-------------------------------------------------------------
# Read the text file (change the filename accordingly)
text_data <- readLines("~/Documents/Genetic-Basis-of-Seed-Trait-Variation-Rice/USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/chr3_downstream.txt")
# Extract the gene IDs by removing "Name="
gene_ids <- sub(".*Name=(Os\\d{2}g\\d{3}).*", "\\1", text_data)
# Keep only valid gene IDs (removes unchanged lines)
gene_ids <- gene_ids[grepl("^Os\\d{2}g\\d{3}$", gene_ids)]
# Print the extracted gene IDs
print(gene_ids)
#-------------------------------------------------------------
# Read the text file (change the filename accordingly)
text_data <- readLines("~/Documents/Genetic-Basis-of-Seed-Trait-Variation-Rice/USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/chr3_downstream.txt")
# Extract the gene IDs by removing "Name="
gene_ids <- sub(".*Name=(Os\\d{2}g\\d{7}).*", "\\1", text_data)
# Keep only valid gene IDs (removes unchanged lines)
gene_ids <- gene_ids[grepl("^Os\\d{2}g\\d{7}$", gene_ids)]
# Print the extracted gene IDs
print(gene_ids)
# Save the extracted gene IDs to a new file
writeLines(gene_ids, "~/Documents/Genetic-Basis-of-Seed-Trait-Variation-Rice/USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/chr3_downstream.txt")
#-------------------------------------------------------------
# Read the text file (change the filename accordingly)
text_data <- readLines("~/Documents/Genetic-Basis-of-Seed-Trait-Variation-Rice/USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/chr7_upstream.txt")
# Extract the gene IDs by removing "Name="
gene_ids <- sub(".*Name=(Os\\d{2}g\\d{7}).*", "\\1", text_data)
# Keep only valid gene IDs (removes unchanged lines)
gene_ids <- gene_ids[grepl("^Os\\d{2}g\\d{7}$", gene_ids)]
# Print the extracted gene IDs
print(gene_ids)
# Save the extracted gene IDs to a new file
writeLines(gene_ids, "~/Documents/Genetic-Basis-of-Seed-Trait-Variation-Rice/USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/chr7_upstream.txt")
#-------------------------------------------------------------
# Read the text file (change the filename accordingly)
text_data <- readLines("~/Documents/Genetic-Basis-of-Seed-Trait-Variation-Rice/USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/chr7_downstream.txt.txt")
# Extract the gene IDs by removing "Name="
gene_ids <- sub(".*Name=(Os\\d{2}g\\d{7}).*", "\\1", text_data)
# Keep only valid gene IDs (removes unchanged lines)
gene_ids <- gene_ids[grepl("^Os\\d{2}g\\d{7}$", gene_ids)]
# Print the extracted gene IDs
print(gene_ids)
# Save the extracted gene IDs to a new file
writeLines(gene_ids, "~/Documents/Genetic-Basis-of-Seed-Trait-Variation-Rice/USDA_minicore/Phenotype_analysis/Results_Phenotype_Analysis/chr7_downstream.txt")
install.packages("jsonlite")
install.packages("igraph")
install.packages("ggraph")
install.packages("tidygraph")  # Optional for advanced visualization
knitr::opts_chunk$set(echo = TRUE)
library(adegenet)
library(ape)
library(ggtree)
library(ggplot2)
library(stats)
library(ips)
library(msa)
library(haplotypes)
library(pegas)
